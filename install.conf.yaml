- defaults:
    link:
      relink: true
      create: true
      force: true

- clean: ['~']

- shell:
  - [git submodule update --init --recursive, Installing submodules]
  - [$DOTFILES_DIR/ConfigNvimProviders.sh, Configure Neovim providers]

- link:
    ~/.tmux.conf:
        path: tmux.conf
    ~/.zprezto:
        path: prezto
    ~/.zshrc:
        create: true
        path:  zshrc
    ~/.zshenv:
        path: zshenv
    ~/.zlogin:
        path: zlogin
    ~/.zlogout:
        path: zlogout
    ~/.zpreztorc:
        path: zpreztorc
    ~/.zprofile:
        path: zprofile
    ~/.gitconfig:
        path: gitconfig
    ~/.dir_colors:
        path: dir_colors
    ~/.gitignore_global:
        path: gitignore_global
    ~/.Xdefaults:
        path: Xdefaults
    ~/.Xresources:
        path: Xresources
    ~/.fonts:
        path: fonts
    ~/.i3:
        path: i3
    ~/bin:
        path: bin
    ~/.zfunc:
        path: zfunc
    ~/.config/mopidy:
        path: mopidy
    ~/.gnupg/gpg.conf:
        path: gnupg/gpg.conf
    ~/.gnupg/gpg-agent.conf:
        path: gnupg/gpg-agent.conf
    ~/.gnupg/dirmngr.conf:
        path: gnupg/dirmngr.conf
    ~/.gnupg/scd-event:
        path: gnupg/scd-event
    ~/.gnupg/scdaemon.conf:
        path: gnupg/scdaemon.conf
    ~/.exports:
        path: exports
    ~/.config/termite:
        path: termite
    ~/.todo/config:
        path: todo/config
    ~/.todo.actions.d:
        path: todo/actions.d
    ~/.config/nvim/init.vim:
        path: nvim/init.vim
    ~/.config/nvim/completion.vim:
        path: nvim/completion.vim
    ~/.config/nvim/after:
        path: nvim/after
    ~/.vim:
        path: ~/.config/nvim
    ~/.vimrc:
        path: ~/.config/nvim/init.vim
    ~/.ssh/config:
        path: ssh/config
    ~/.config/compton.conf:
        path: compton.conf
    ~/.xsessionrc:
        path: xsessionrc
    ~/.local/bin/nvr:
      path: ~/.virtualenvs/neovim3/bin/nvr
    ~/.local/bin/flake8:
      path: ~/.virtualenvs/neovim3/bin/flake8
    ~/.local/bin/npm:
      path: ~/.virtualenvs/neovim3/bin/npm
    ~/.local/bin/node:
      path: ~/.virtualenvs/neovim3/bin/node
    ~/.local/bin/neovim-node-host:
      path: ~/.virtualenvs/neovim3/bin/neovim-node-host
    ~/.tmux-powerlinerc:
        path: tmux-powerlinerc
    ~/.config/tmux/powerline:
        path: tmux/powerline

- shell:
    - [mkdir -p ~/.config/nvim/pack/minpac/opt, Make minpac install destination]

    - [rm -rf ~/.config/nvim/pack/minpac/opt/minpac, Delete old minpac plugin]

    -
      command: git clone --depth 1 https://github.com/k-takata/minpac ~/.config/nvim/pack/minpac/opt/minpac
      description: Installing minpac

    -
      command: "nvim -c \"call minpac#update('', {'do': 'quit'})\" --headless"
      description: Installing nvim plugins

    -
      command: ~/.config/nvim/pack/minpac/start/fzf/install --completion --key-bindings --update-rc --no-bash --no-fish
      description: Configure fzf for zsh

    -
      command: ~/.config/nvim/pack/minpac/start/fzf/install --bin
      description: Install fzf binary
    -
      command: chmod 700 ~/.gnupg
      description: Fix home gnupg homedir

    -
      command: mkdir -p ~/.config/tmux/plugins
      description: Make tmux plugin directory

    -
      command: bash -c "[[ -d ~/.config/tmux/plugins/tpm ]] || git clone https://github.com/tmux-plugins/tpm.git ~/.config/tmux/plugins/tpm"
      description: Install tpm

    - command: ~/.config/tmux/plugins/tpm/bin/install_plugins
      description: Install tmux plugins

